version: 2.1
orbs:
    pus: navikt/pus-orb@0.0.34

workflows:
    version: 2
    commit:
        jobs:
            - pus/test-frontend:
                  name: test
                  context: pus
            - pus/bygg-og-deploy-frontend:
                  requires:
                      - test
                  context: pus
                  cluster: dev-fss
                  filepath: ./nais-q-fss.yaml
                  filters:
                      branches:
                          only: dev
            - pus/bygg-og-deploy-frontend:
                  requires:
                      - test
                  context: pus
                  cluster: dev-sbs
                  filepath: ./nais-q-sbs.yaml
                  filters:
                      branches:
                          only: dev
            - pus/bygg-og-deploy-frontend:
                  requires:
                      - test
                  context: pus
                  cluster: prod-fss
                  filepath: ./nais-fss.yaml
                  filters:
                      branches:
                          only: master
            - pus/deploy-latest:
                  name: prod-sbs-deploy
                  requires:
                      - test
                  context: pus
                  cluster: prod-sbs
                  filepath: ./nais-sbs.yaml
                  filters:
                      branches:
                          only: master

